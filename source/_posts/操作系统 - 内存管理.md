---
title: 操作系统 - 内存管理
date: 2022-11-08 10:16:37   
permalink:         
categories:  
    - 操作系统
    -
    -       
tags: 
    - 操作系统
    - 内存管理     
description:        
image:             
copyright: true     
---

<img src="https://" alt="" style="width:100%" />  

**前言**

操作系统内存管理策略

<!-- more -->

# 背景
## 逻辑地址和物理地址


### 动态链接
### 动态加载
### 绑定
# 交换
- 进程可以暂时被交换到内存外的一个备份区，然后可以被换回内存继续执行
- **备份区** 

# 连续内存分配

## 分类

### 单一连续分配
- 单道程序环境下，整个内存空间爱你由该程序独占
- 内存分配管理简单，内存利用率低

### 固定分区分配
- 预先把可分配的内存空间分割成若干连续区域，称为一个分区
- 内存分配时，如果有一个空闲分区，则分配给进程，进程运行结束时，其分区被收回
- **每个分区只能装一个程序**

### 可变分区分配
- 不同大小分区分布在整个内存中
- 当一个进程到来的时候，它将从一个足够容纳它分区中分配内存

## 存储分配算法
- 
- 首次适应(First-fit) - 最先找到的分区
- 最佳适应(Best-fit) - 适合条件的最小分区
- 最差适应(Worst-fit) - 寻找最大分区

## 内存回收
- 回收内存块前后无空闲块
- 回收内存块前有后无空闲块
- 回收内存块前无后有空闲块
- 回收内存块前后均有空闲块

## 碎片
### 外碎片
- 整个可用的内存空间可以用来满足一个请求**但不连续**

### 内碎片
- 分配的内存可能比申请的内存大一点，在分区内部但不被使用

### 通过紧缩减少外碎片
- 小的空闲内存结合成一个大的块
- 只有重定位是动态的时候，并且在运行时，才可能紧缩
# 分页内存管理

## 分页
- 把物理内存分成大小固定的块，称为帧
- 把逻辑内存分为统一大小的块，称为页
- 系统保留所有空闲帧的记录
- 建立一个页表，把逻辑地址转化为物理地址
- 不会产生外碎片
- 存在内碎片

## 地址转换机制
- 页号 - 包含页在物理内存中的基址，作为索引
- 页偏移 - 同基址结合，用来确定送入内存设备的物理内存地址

## 联想寄存器/TLB
- 如果地址在联想寄存器中，取出帧号
- 否则从内存中的页表取出帧号
![[Pasted image 20221114135140.png]]

### 有效访问时间
命中率 - 在联想寄存器中找到页号的百分比, 比率与联想寄存器的 大小有关
命中率  $=\lambda$
有效访问时间 (EAT), 根据概率对每种情况进行加权得到, 类似于平 均访问时间
联想寄存器的查找需要时间单位a微秒
假设内存一次存取需要b微秒

$E A T=\lambda(a+b)+(1-\lambda)(a+2 b)$

## 内存保护

## 页共享

# 页表结构
## 层次页表
- p1 外页表的索引
- p2 外页表的叶偏移
![[Pasted image 20221114141756.png]]

## 哈希页表
![[Pasted image 20221114143510.png]]

## 反向页表
- 每个条目保存真正内存位置的页的虚拟地址

![[Pasted image 20221114143624.png]]

# more

<hr />
版权信息