---
title: 操作系统-虚拟内存管理 
date: 2022-11-21 13:25:05   
permalink:         
categories:  
    - 操作系统
    -
    -       
tags: 
    - 操作系统
    - 内存管理           
description:        
image:             
copyright: true     
---

<img src="https://" alt="" style="width:100%" />  

**前言**


操作系统-虚拟内存管理 


<!-- more -->

# 虚拟存储技术
- 代码必须装入内存才能执行，但不是所有代码都要装入内存
## 虚拟内存技术
- 当进程运行时，先将其一部分装入内存，另一部分暂留磁盘，当要执行的指令或数据不再内存时，由操作系统自动将它们调入内存执行
## 虚拟地址空间
- 分配给进程的虚拟内存
## 虚拟地址
- 在虚拟内存中指令或者数据的位置
## 虚拟内存
- 把内存和磁盘结合起来使用得到一个容量很大的“内存”，既**虚存**
- 允许文件和内存**通过共享页**为多个进程所共享
- 允许更有效的进程创建

## 执行实现
- 虚拟页式
- 虚拟段式

# 请求分页
- 只在一个页需要的时候才把它换入内存

## 基本概念
### 有效-无效位
- 1表示该页表在内存中
- 0表示该页表不在内存中

### 缺页中断
- 对标记为无效(不在内存中)的页表
#### 过程
1. 访问指令或数据，检查是否无效
2. 若有效，则进行后续调入
3. 找到页在后备存储的位置
4. 得到空的页框，把页换入页框
5. 重新设置页表，设置有效位
6. 重启中断的指令 
### 纯请求分页
- 只有在需要的时和才将页面调入内存

### 硬件支持
- 带有有效无效位的页表
- 交换空间
- 指令重启

## 性能
### 缺页率  p
- 缺页的概率 0~1.0

### 有效访问时间  EAT
- $EAT = (1-p)\times 内存访问世界 + p \times 页错误时间$

### 页错误时间
处理缺页中断 + 页交换时间 + 读入页时间 + 重启进程开销

### 优化
- 页面转换时采用交换空间
- 进程装载时，把整个进程拷贝到交换区


# 页面置换
- 没有空闲页时找到内存没有使用的一些页换出

## 基本方法
1. 查找所需页的位置
2. 查找空闲页框
	- 若有空闲页框，则使用它
	- 若没有空闲页框，使用置换算法置换一个页框，将置换出的内容写入磁盘
3. 将所需页读入空闲页框，更新页表、帧表
4. 重启用户进程

## 页置换算法
- 达到最小的缺页率

### 先进先出算法(FIFO)
- 置换**在内存中驻留时间最长**的页面
![[Pasted image 20221124200204.png]]

### 最优置换算法
- 置换**将来不再需要或在最远的将来不被使用**的页
- 不容易实现，作为衡量其他算法性能的标准
![[Pasted image 20221124200514.png]]

### 最近最少使用算法(LRU)
- 置换**最长时间没有使用**的页
![[Pasted image 20221124200648.png]]

# 页框分配
- 也称帧分配

### 固定分配
- 为每个进程分配固定数量的页框
- 平均分配
- 按比率分配

### 优先级分配
- 根据优先级来使用比率分配

# 颠簸
- 一个进程经常换入换出
## 原因
- 一个进程没有足够的页
- 系统内存不足
- 页面置换算法不合理
## 解决
- **减少多道程序的道数**


# 内核内存分配

![[Pasted image 20221124211921.png]]

![[Pasted image 20221124212028.png]]
# xx3x

<hr />
版权信息