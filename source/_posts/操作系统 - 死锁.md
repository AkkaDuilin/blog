---
title: 操作系统 - 死锁 
date: 2022-11-07 12:40:45   
permalink:         
categories:  
    - 操作系统
    -
    -       
tags: 
    - 操作系统
    - 死锁问题         
description:        
image:             
copyright: true     
---

<img src="https://" alt="" style="width:100%" />  

**前言**


操作系统死锁问题


<!-- more -->

# 死锁概念
- 一组等待进程，其中每一个进程都持有资源，并且等待着由这个组中其他进程所持有的资源
## 特征(必要条件)
- **四个条件同时出现，死锁发生**
### 互斥
- 一次只有一个进程可以使用一个资源
### 占有并等待
- 一个至少持有一个资源的进程等待获得而额外的由其他进程所持有的资源
### 不可抢占
- 一个资源只有当持有它的进程完成任务后，才会释放
### 循环等待
- 等待资源存在环
## 资源分配图
- 申请边表示P申请了R的一个实例
- 分配边表示R的一个实例分配给了P

![[Pasted image 20221107145404.png]]
### 如果资源分配图没有环，系统不处于死锁状态
### 如果有环
- 每种类型只有一个实例，一定死锁
- 一种类型由多个实例，可能死锁

# 死锁预防/避免
## 预防
- 确保至少一个必要条件不成立
- 资源静态分配法
### 互斥
- 非共享资源必须互斥
- 将互斥资源改造为共享资源
### 占有并等待
- 保证进程申请资源时没有占有其他资源
- 静态分配策略
### 非抢占
- 如果一个进程的申请没有实现要释放所占有的资源
### 循环等待
- 对所有资源类型进行排序按照顺序申请

## 避免

```ad-tip
# 死锁和不安全状态的关系
- 不安全状态不一定死锁
- 安全状态一定不死锁
```

### 资源分配图算法
![[Pasted image 20221108163016.png]]
### 银行家算法
#### 数据结构
![[Pasted image 20221108163218.png]]
#### 安全算法
![[Pasted image 20221108163438.png]]


#### 是否满足Pi的资源申请

![[Pasted image 20221108163322.png]]


![[Pasted image 20221107144116.png]]

# 死锁检测和恢复
### 检测
- 调用算法检查是否有环  资源分配图简化法

### 恢复
####  进程终止
- 中断所有死锁进程
- 一次中断一个直到死锁环消失
#### 抢占资源
- 把抢占的资源分配给其他继承使用，直到死锁打破


```ad-question
![[Pasted image 20221107144029.png]]
```

# MORE

<hr />
版权信息